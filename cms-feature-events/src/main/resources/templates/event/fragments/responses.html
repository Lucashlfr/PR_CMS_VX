<div th:fragment="responses(exportRows, mapping, active, noFeedback)" class="card card-collapsable mb-3">
    <a class="card-header d-flex justify-content-between align-items-center py-2"
       role="button"
       data-bs-toggle="collapse"
       data-bs-target="#collapse-responses"
       aria-controls="collapse-responses"
       aria-expanded="false">
        <span><i class="mdi mdi-account-multiple-check text-yellow"></i> R端ckmeldungen</span>
        <i class="mdi mdi-chevron-down card-collapsable-arrow"></i>
    </a>

    <div class="collapse" id="collapse-responses">
        <div class="card-body">
            <style>
                .equal-column-table td, .equal-column-table th {
                    width: 1%; white-space: nowrap; text-align: left; vertical-align: middle;
                }
                .equal-column-table img.table-preview { max-width: 120px; max-height: 60px; }
            </style>

            <div class="row">
                <div class="col-xl-2">
                    <div class="chart-pie mb-4">
                        <!-- eindeutige ID nur f端r dieses Fragment -->
                        <canvas id="responsesChart" width="100%" height="25"></canvas>
                    </div>
                    <div class="list-group list-group-flush">
                        <div class="list-group-item d-flex align-items-center justify-content-between small px-0 py-2">
                            <div class="me-3"><i class="mdi mdi-circle me-1 text-yellow"></i>Personen ohne Mapping</div>
                            <div class="fw-500 text-dark" id="mapping" th:text="${mapping}"></div>
                        </div>
                        <div class="list-group-item d-flex align-items-center justify-content-between small px-0 py-2">
                            <div class="me-3"><i class="mdi mdi-circle me-1 text-green"></i>Angemeldet</div>
                            <div class="fw-500 text-dark" id="register" th:text="'' + ${active}"></div>
                        </div>
                        <div class="list-group-item d-flex align-items-center justify-content-between small px-0 py-2">
                            <div class="me-3"><i class="mdi mdi-circle me-1 text-red"></i>Abgemeldet</div>
                            <div class="fw-500 text-dark" id="cancelled" th:text="'0'"></div>
                        </div>
                        <div class="list-group-item d-flex align-items-center justify-content-between small px-0 py-2">
                            <div class="me-3"><i class="mdi mdi-circle me-1 text-gray-400"></i>Keine R端ckmeldung</div>
                            <div class="fw-500 text-dark" id="noFeedback" th:text="${noFeedback}"></div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-10">
                    <table class="table equal-column-table table-sm">
                        <thead>
                        <tr>
                            <th th:each="header : ${exportRows[0]}" th:text="${header}">Header</th>
                            <th>Aktion</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="row, rowStat : ${exportRows}" th:if="${rowStat.index > 0}">
                            <td th:each="cell : ${row}">
                                <span th:if="${#strings.startsWith(cell, 'data:image/')}">
                                    <a th:href="${cell}" target="_blank">
                                        <img th:src="${cell}" class="table-preview" alt="Bildvorschau"/>
                                    </a>
                                </span>
                                <span th:unless="${#strings.startsWith(cell, 'data:image/')}" th:text="${cell}">Text</span>
                            </td>
                            <td>
                                <a href="#" class="link-primary open-map-modal" th:attr="data-resultid=${row[0]}" data-bs-toggle="modal" data-bs-target="#map">
                                    Person verkn端pfen
                                </a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
